import streamlit as st
import os

# --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏¥‡∏ä‡∏≤ (Database ‡∏Å‡∏•‡∏≤‡∏á) ---
all_courses_db = {
    # ‡∏£‡∏´‡∏±‡∏™‡∏ß‡∏¥‡∏ä‡∏≤: [‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï, "‡∏ß‡∏±‡∏ô‡∏™‡∏≠‡∏ö", "‡∏Ñ‡∏≤‡∏ö", "‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏¥‡∏ä‡∏≤", "‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà"]
    "RAM1101": [3, "4", "A", "‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢", "RAM"], "RAM1111": [3, "4", "B", "‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© 1", "RAM"],
    "RAM1112": [3, "3", "B", "‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏© 2", "RAM"], "RAM1132": [3, "3", "A", "‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏°‡∏∏‡∏î", "RAM"],
    "RAM1141": [3, "2", "A", "‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏•‡∏¥‡∏Å‡∏†‡∏≤‡∏û", "RAM"], "RAM1204": [3, "3", "B", "‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏Ñ‡∏¥‡∏î", "RAM"],
    "RAM1213": [3, "3", "A", "‡∏ß‡∏¥‡∏ä‡∏≤ RAM", "RAM"], "RAM1301": [3, "4", "B", "‡∏Ñ‡∏∏‡∏ì‡∏ò‡∏£‡∏£‡∏°", "RAM"],
    "RAM1303": [3, "2", "B", "‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏®‡∏≤‡∏™‡∏ï‡∏£‡πå", "RAM"], "RAM1312": [3, "4", "B", "‡∏ß‡∏¥‡∏ä‡∏≤ RAM", "RAM"],
    "LAW1101": [2, "2", "A", "‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏°‡∏´‡∏≤‡∏ä‡∏ô", "LAW"], "LAW1102": [2, "4", "A", "‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏≠‡∏Å‡∏ä‡∏ô", "LAW"],
    "LAW1103": [3, "2", "A", "‡∏ô‡∏¥‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°", "LAW"], "LAW2101": [3, "2", "B", "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå", "LAW"],
    "LAW2102": [3, "3", "A", "‡∏´‡∏ô‡∏µ‡πâ", "LAW"], "LAW2104": [3, "2", "B", "‡∏£‡∏±‡∏ê‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç", "LAW"],
    "LAW2105": [3, "4", "A", "‡∏ã‡∏∑‡πâ‡∏≠‡∏Ç‡∏≤‡∏¢", "LAW"], "LAW2106": [3, "4", "A", "‡∏≠‡∏≤‡∏ç‡∏≤ 1", "LAW"],
    "LAW2107": [3, "1", "B", "‡∏≠‡∏≤‡∏ç‡∏≤ 2", "LAW"], "LAW2109": [3, "3", "B", "‡∏¢‡∏∑‡∏° ‡∏ù‡∏≤‡∏Å", "LAW"],
    "LAW2110": [2, "1", "B", "‡∏Ñ‡πâ‡∏≥ ‡∏à‡∏≥‡∏ô‡∏≥", "LAW"], "LAW2111": [2, "3", "A", "‡∏ï‡∏±‡∏ß‡πÅ‡∏ó‡∏ô", "LAW"],
    "LAW2112": [2, "4", "B", "‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô", "LAW"], "LAW2113": [3, "2", "A", "‡∏ï‡∏±‡πã‡∏ß‡πÄ‡∏á‡∏¥‡∏ô", "LAW"],
    "LAW2108": [2, "1", "A", "‡πÄ‡∏ä‡πà‡∏≤ ‡∏à‡πâ‡∏≤‡∏á", "LAW"], "LAW3101": [2, "1", "A", "‡∏≠‡∏≤‡∏ç‡∏≤ 3", "LAW"],
    "LAW3102": [3, "4", "B", "‡∏´‡∏∏‡πâ‡∏ô‡∏™‡πà‡∏ß‡∏ô", "LAW"], "LAW3103": [3, "1", "B", "‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß", "LAW"],
    "LAW3104": [2, "3", "A", "‡∏ò‡∏£‡∏£‡∏°‡∏ô‡∏π‡∏ç‡∏®‡∏≤‡∏•", "LAW"], "LAW3105": [3, "1", "B", "‡∏ß‡∏¥.‡πÅ‡∏û‡πà‡∏á 1", "LAW"],
    "LAW3106": [3, "4", "B", "‡∏ß‡∏¥‡∏≠‡∏≤‡∏ç‡∏≤ 1", "LAW"], "LAW3109": [3, "3", "B", "‡∏°‡∏£‡∏î‡∏Å", "LAW"],
    "LAW3110": [2, "1", "A", "‡∏•‡πâ‡∏°‡∏•‡∏∞‡∏•‡∏≤‡∏¢", "LAW"], "LAW3111": [3, "2", "A", "‡∏û‡∏¢‡∏≤‡∏ô", "LAW"],
    "LAW3112": [3, "1", "B", "‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢‡∏õ‡∏Å‡∏Ñ‡∏£‡∏≠‡∏á", "LAW"], "LAW3117": [2, "1", "A", "‡∏õ.‡∏ß‡∏¥‡∏°‡∏´‡∏≤‡∏ä‡∏ô", "LAW"],
    "LAW4101": [2, "1", "A", "‡∏†‡∏≤‡∏©‡∏µ", "LAW"], "LAW4102": [3, "2", "B", "‡∏ß‡πà‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°", "LAW"],
    "LAW4103": [3, "4", "A", "‡∏Ñ‡∏î‡∏µ‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "LAW"], "LAW4104": [2, "2", "B", "‡πÅ‡∏£‡∏á‡∏á‡∏≤‡∏ô", "LAW"],
    "LAW4105": [2, "2", "A", "‡∏ß‡∏¥‡∏ä‡∏≤‡∏ä‡∏µ‡∏û‡∏ó‡∏ô‡∏≤‡∏¢", "LAW"], "LAW4106": [2, "3", "A", "‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡∏ä‡∏ô", "LAW"],
    "LAW4107": [2, "2", "B", "‡∏õ‡∏£‡∏±‡∏ä‡∏ç‡∏≤", "LAW"], "LAW4108": [3, "2", "B", "‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô", "LAW"],
    "LAW4109": [3, "4", "A", "‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤", "LAW"], "LAW4110": [2, "1", "A", "‡∏Ñ‡πâ‡∏≤‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®", "LAW"],
    "LAW3133": [3, "3", "B", "‡∏≠‡∏≤‡∏ä‡∏ç‡∏≤‡∏Å‡∏£", "ELECTIVE"], "LAW3138": [2, "1", "B", "‡πÄ‡∏î‡πá‡∏Å", "ELECTIVE"],
    "LAW4134": [2, "1", "B", "‡∏ó‡∏∞‡πÄ‡∏•", "ELECTIVE"], "LAW4156": [2, "2", "A", "‡∏≠‡∏¥‡πâ‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢", "ELECTIVE"]
}

st.set_page_config(page_title="Exam Slot Planner", layout="wide")

# --- 2. CSS ---
st.markdown("""
    <style>
    header {visibility: hidden;}
    .slot-label {
        background-color: #2c3e50;
        color: white;
        padding: 5px 10px;
        border-radius: 5px;
        font-weight: bold;
        text-align: center;
        margin-bottom: 5px;
    }
    .stSelectbox label { display: none; }
    </style>
    """, unsafe_allow_html=True)

st.title("‚öñÔ∏è Law Registration by Exam Slots")

tab1, tab2 = st.tabs(["üìä ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î", "üìÖ ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô (‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≤‡∏ö‡∏™‡∏≠‡∏ö)"])

with tab1:
    st.info("‡∏´‡∏ô‡πâ‡∏≤‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î (GPA) ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ñ‡∏£‡∏±‡∏ö")
    # ... (Logic ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏Å‡∏£‡∏î‡πÄ‡∏î‡∏¥‡∏°)

with tab2:
    st.subheader("‡∏à‡∏±‡∏î‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏≤‡∏ö‡∏™‡∏≠‡∏ö (1A - 4B)")
    col_y, col_t, col_g = st.columns([1, 1, 1])
    y_sel = col_y.selectbox("‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤", [1, 2, 3, 4])
    t_sel = col_t.selectbox("‡πÄ‡∏ó‡∏≠‡∏°", ["1", "2", "S"])
    is_grad = col_g.toggle("üéì ‡∏Ç‡∏≠‡∏à‡∏ö (‡∏•‡∏á‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô‡πÑ‡∏î‡πâ)")

    st.divider()
    
    # ‡∏•‡∏¥‡∏™‡∏ï‡πå‡∏Ñ‡∏≤‡∏ö‡∏™‡∏≠‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î 8 ‡∏Ñ‡∏≤‡∏ö
    slots = ["1A", "1B", "2A", "2B", "3A", "3B", "4A", "4B"]
    total_creds = 0
    term_key = f"Y{y_sel}T{t_sel}"

    # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏™‡∏•‡πá‡∏≠‡∏ï
    cols = st.columns(4) # ‡πÅ‡∏ñ‡∏ß‡∏•‡∏∞ 4 ‡∏™‡∏•‡πá‡∏≠‡∏ï
    
    for i, slot_name in enumerate(slots):
        with cols[i % 4]:
            st.markdown(f"<div class='slot-label'>‡∏Ñ‡∏≤‡∏ö‡∏™‡∏≠‡∏ö {slot_name}</div>", unsafe_allow_html=True)
            
            # ‡∏Å‡∏£‡∏≠‡∏á‡∏ß‡∏¥‡∏ä‡∏≤‡∏à‡∏≤‡∏Å Database ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ß‡∏±‡∏ô‡∏™‡∏≠‡∏ö‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Slot ‡∏ô‡∏µ‡πâ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô
            day = slot_name[0] # "1", "2", "3", "4"
            period = slot_name[1] # "A", "B"
            
            available_in_slot = ["-"] + [
                f"{code} | {info[3]}" for code, info in all_courses_db.items() 
                if info[1] == day and info[2] == period
            ]
            
            selected = st.selectbox(f"Select {slot_name}", available_options=available_in_slot, key=f"slot_{term_id}_{slot_name}")
            
            if selected != "-":
                code = selected.split(" | ")[0]
                info = all_courses_db[code]
                total_creds += info[0]
                st.caption(f"‚úÖ {info[0]} ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï")
            else:
                st.caption("‡∏ß‡πà‡∏≤‡∏á (‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ä‡∏≤)")

    st.divider()
    max_c = 30 if is_grad else (9 if t_sel == "S" else 22)
    st.metric("‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡∏£‡∏ß‡∏°‡πÄ‡∏ó‡∏≠‡∏°‡∏ô‡∏µ‡πâ", f"{total_creds} / {max_c}")
    
    if total_creds > max_c:
        st.error(f"‚ùå ‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Å‡∏¥‡∏ï‡πÄ‡∏Å‡∏¥‡∏ô {max_c}!")
    elif total_creds > 0:
        st.success("‚úÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏≠‡∏ö‡∏•‡∏á‡∏ï‡∏±‡∏ß (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏≤‡∏á‡∏™‡∏≠‡∏ö‡∏ä‡∏ô‡∏Å‡∏±‡∏ô‡πÅ‡∏ô‡πà‡∏ô‡∏≠‡∏ô)")

st.markdown("---")
if st.button("üßß ‡πÇ‡∏î‡πÄ‡∏ô‡∏ó‡∏™‡∏ô‡∏±‡∏ö‡∏™‡∏ô‡∏∏‡∏ô"):
    if os.path.exists("donate.jpg"): st.image("donate.jpg", use_container_width=True)
