import streamlit as st
import graphviz

st.set_page_config(page_title="Law Dashboard", layout="wide")

# --- 1. ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏ï‡∏≤‡∏° "‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô" (‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏á‡πà‡∏≤‡∏¢‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤‡∏Å) ---
groups = {
    "‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô": {
        "1. ‡∏Å‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏™‡∏±‡∏ç‡∏ç‡∏≤": ["680", "681", "681/1", "682", "685", "699"],
        "2. ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏á & ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤": ["686", "687", "688", "689", "690", "692", "701"],
        "3. ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πÑ‡∏•‡πà‡πÄ‡∏ö‡∏µ‡πâ‡∏¢ & ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏∞‡∏á‡∏±‡∏ö": ["693", "694", "695", "696", "697"]
    },
    "‡∏à‡∏≥‡∏ô‡∏≠‡∏á": {
        "1. ‡∏™‡∏±‡∏ç‡∏ç‡∏≤ & ‡πÅ‡∏ö‡∏ö": ["702", "703", "705", "709", "711", "712", "713", "714", "714/1", "715", "716"],
        "2. ‡∏Ç‡∏≠‡∏ö‡πÄ‡∏Ç‡∏ï‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏à‡∏≥‡∏ô‡∏≠‡∏á": ["718", "719", "720", "721", "722"],
        "3. ‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≠‡∏á & ‡∏ú‡∏•": ["724", "727/1", "728", "729/1", "733", "745"]
    },
    "‡∏à‡∏≥‡∏ô‡∏≥": {
        "‡∏ó‡∏∏‡∏Å‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô": ["747", "748", "758", "762", "763", "764", "767"]
    }
}

# --- 2. ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏¢‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏é‡∏µ‡∏Å‡∏≤ ---
section_details = {
    "680": {"title": "‡∏´‡∏•‡∏±‡∏Å‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô", "desc": "‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏´‡∏•‡∏±‡∏Å‡∏ê‡∏≤‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠", "dika": "‡∏é‡∏µ‡∏Å‡∏≤ 1923/2560"},
    "686": {"title": "‡∏Å‡∏≤‡∏£‡∏ö‡∏≠‡∏Å‡∏Å‡∏•‡πà‡∏≤‡∏ß", "desc": "‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ö‡∏≠‡∏Å‡∏Å‡∏•‡πà‡∏≤‡∏ß‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 60 ‡∏ß‡∏±‡∏ô", "dika": "‡∏é‡∏µ‡∏Å‡∏≤ 5543/2562"},
    "714": {"title": "‡πÅ‡∏ö‡∏ö‡∏Ç‡∏≠‡∏á‡∏à‡∏≥‡∏ô‡∏≠‡∏á", "desc": "‡∏ó‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏à‡∏î‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô", "dika": "‡∏é‡∏µ‡∏Å‡∏≤ 698/2522"},
    "733": {"title": "‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≤‡∏î", "desc": "‡∏ñ‡πâ‡∏≤‡∏Ç‡∏≤‡∏¢‡∏ó‡∏≠‡∏î‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö ‡∏•‡∏π‡∏Å‡∏´‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° (‡πÄ‡∏ß‡πâ‡∏ô‡πÅ‡∏ï‡πà‡∏ï‡∏Å‡∏•‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏ß‡πâ)", "dika": "‡∏é‡∏µ‡∏Å‡∏≤ 15155/2555"},
    "747": {"title": "‡∏´‡∏•‡∏±‡∏Å‡∏à‡∏≥‡∏ô‡∏≥", "desc": "‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏™‡∏¥‡∏ô", "dika": "‡∏é‡∏µ‡∏Å‡∏≤ 2023/2519"},
    # ... ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡∏•‡∏á‡πÉ‡∏ô‡∏Å‡πâ‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ ...
}

# --- 3. ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡πÅ‡∏≠‡∏õ (Minimal Header) ---
st.title("‚öñÔ∏è Legal Mastery Dashboard")
st.caption("‡∏£‡∏ß‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏Å‡∏é‡∏´‡∏°‡∏≤‡∏¢ - ‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô ‡∏à‡∏≥‡∏ô‡∏≥ ‡∏à‡∏≥‡∏ô‡∏≠‡∏á")
st.write("---")

# --- 4. Main Navigation (‡πÉ‡∏ä‡πâ Tabs ‡πÅ‡∏ó‡∏ô Sidebar ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ã‡πâ‡∏≥‡∏ã‡πâ‡∏≠‡∏ô) ---
tab_surety, tab_mortgage, tab_pledge = st.tabs(["üìò ‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô", "üìó ‡∏à‡∏≥‡∏ô‡∏≠‡∏á", "üìô ‡∏à‡∏≥‡∏ô‡∏≥"])

def render_subject(subject_name):
    col1, col2 = st.columns([1, 2])
    
    with col1:
        st.subheader("üìå ‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà")
        # ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏°‡∏≤‡∏ï‡∏£‡∏≤‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏Å‡∏•‡∏∏‡πà‡∏°
        for group_name, sections in groups[subject_name].items():
            with st.expander(f"üìÅ {group_name}"):
                for s in sections:
                    if st.button(f"‡∏°. {s}", key=f"btn_{subject_name}_{s}"):
                        st.session_state[f"selected_{subject_name}"] = s

    with col2:
        current_s = st.session_state.get(f"selected_{subject_name}", groups[subject_name][list(groups[subject_name].keys())[0]][0])
        
        st.subheader(f"üîç ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î ‡∏°. {current_s}")
        detail = section_details.get(current_s, {"title": "‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏≤‡∏ï‡∏£‡∏≤", "desc": "‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏≤ (‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)", "dika": "‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°"})
        
        # ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÅ‡∏ö‡∏ö Card
        st.info(f"**{detail['title']}**")
        st.write(detail['desc'])
        st.warning(f"‚öñÔ∏è **‡∏é‡∏µ‡∏Å‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç:** {detail['dika']}")
        
        # ‡πÅ‡∏ú‡∏ô‡∏ú‡∏±‡∏á‡∏¢‡πà‡∏≠ (‡∏ß‡∏≤‡∏î‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏à‡∏∏‡∏î‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏£‡∏Å)
        st.write("---")
        st.caption("üí° ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á")
        dot = graphviz.Digraph()
        dot.attr(rankdir='LR', size='5')
        dot.attr('node', shape='box', style='filled, rounded', fillcolor='#f0f2f6')
        dot.node(current_s, f"‡∏°. {current_s}", fillcolor='#FFD700')
        # ‡πÅ‡∏™‡∏î‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏Ñ‡∏£‡πà‡∏≤‡∏ß‡πÜ
        st.graphviz_chart(dot)

with tab_surety:
    render_subject("‡∏Ñ‡πâ‡∏≥‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô")

with tab_mortgage:
    render_subject("‡∏à‡∏≥‡∏ô‡∏≠‡∏á")

with tab_pledge:
    render_subject("‡∏à‡∏≥‡∏ô‡∏≥")
